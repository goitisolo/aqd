PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX cr: <http://cr.eionet.europa.eu/ontologies/contreg.rdf#>
PREFIX aqd: <http://rdfdata.eionet.europa.eu/airquality/ontology/>
PREFIX aq: <http://reference.eionet.europa.eu/aq/ontology/>
PREFIX rod: <http://rod.eionet.europa.eu/schema.rdf#>


SELECT DISTINCT
#concat(xsd:string(?envelope), xsd:string(?assmURI)) as ?_id
concat(?AssessmentId, ?ReportingYear, ?ModelId, ?SamplingPointId)  as ?_id
?CountryOrTerritory
?AssessmentId
?Namespace
?Pollutant
?Zone as ?ZoneId
YEAR(?ReportingBegin) AS ?ReportingYear
?ObjectiveType
?ReportingMetric
?ProtectionTarget
?ExceedanceAttainment
?ClassificationDate
?ClassificationReport
?AssessmentType
?Description
?ModelId
?SamplingPointId
?envelope


 WHERE {

?areURI a aqd:AQD_AssessmentRegime;
       
    aqd:inspireId ?inspireId.
    ?inspireId aqd:localId ?AssessmentId.
    ?inspireId aqd:namespace ?Namespace.
?areURI aqd:pollutant ?PollutantURI;
    aqd:zone ?ZoneURI;
    aqd:declarationFor ?declaration .
    ?declaration aq:reportingBegin ?ReportingBegin .
 ?areURI   aqd:assessmentMethods ?assmURI ;
           aqd:assessmentThreshold ?assURI .
             ?assURI aqd:environmentalObjective ?environmentalObjective .    
           ?environmentalObjective  aqd:objectiveType ?ObjectiveTypeURI.    
           ?environmentalObjective aqd:reportingMetric ?ReportingMetricURI .
           ?environmentalObjective aqd:protectionTarget ?ProtectionTargetURI .
              ?assURI aqd:exceedanceAttainment ?ExceedanceAttainmentURI .
              ?assURI aqd:classificationDate ?classdateURI .
                  ?classdateURI rdfs:label ?ClassificationDate .       
              ?assmURI aqd:assessmentType ?AssessmentTypeURI .     
                  ?AssessmentTypeURI rdfs:label ?AssessmentType .

OPTIONAL{?assmURI aqd:assessmentTypeDescription ?Description} .
OPTIONAL{?assmURI aqd:modelAssessmentMetadata ?ModelAssessmentMetadataURI} .
OPTIONAL{?assmURI aqd:samplingPointAssessmentMetadata ?samplingPointURI} .

OPTIONAL{?ModelAssessmentMetadataURI aqd:inspireId ?ModelId} .
OPTIONAL{?samplingPointURI aq:inspireId ?SamplingPointId} .


?areURI a aqd:AQD_AssessmentRegime;
     aqd:zone ?ZoneURI.
 ?ZoneURI aq:inspireId ?Zone .

?PollutantURI rdfs:label ?Pollutant .
?ObjectiveTypeURI rdfs:label ?ObjectiveType .
?ReportingMetricURI rdfs:label ?ReportingMetric .
?ProtectionTargetURI rdfs:label ?ProtectionTarget .
?ExceedanceAttainmentURI rdfs:label ?ExceedanceAttainment .


 ?envelope rod:hasFile ?source .
 ?envelope rod:locality ?locURI .
 ?locURI rdfs:label ?CountryOrTerritory .
 ?envelope rod:obligation <http://rod.eionet.europa.eu/obligations/671> .
 <http://rod.eionet.europa.eu/obligations/671> dcterms:title ?Obligation .

OPTIONAL{?assURI aqd:classificationReport ?ClassificationReport} .

FILTER regex(?Namespace,"ES.BDCA.AQ") .
#FILTER regex(?PollutantURI, "") .
            
#ORDER BY ?ReportingBegin ?Pollutant ?ReportingMetric
}
